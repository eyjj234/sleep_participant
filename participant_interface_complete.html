<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ìˆ˜ë©´ ë°ì´í„° ìˆ˜ì§‘ - ì°¸ê°€ì í˜ì´ì§€</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
          "Apple SD Gothic Neo", sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 600px;
        margin: 0 auto;
      }

      .card {
        background: white;
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        margin-bottom: 20px;
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
      }

      .header h1 {
        font-size: 28px;
        color: #333;
        margin-bottom: 10px;
      }

      .header .subtitle {
        color: #666;
        font-size: 14px;
      }

      .input-group {
        margin-bottom: 20px;
      }

      .input-group label {
        display: block;
        font-size: 14px;
        color: #666;
        margin-bottom: 8px;
        font-weight: 600;
      }

      .input-group input {
        width: 100%;
        padding: 15px;
        border: 2px solid #e9ecef;
        border-radius: 10px;
        font-size: 16px;
        transition: border-color 0.3s;
      }

      .input-group input:focus {
        outline: none;
        border-color: #667eea;
      }

      .btn {
        width: 100%;
        padding: 15px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
      }

      .btn:hover:not(:disabled) {
        background: #5568d3;
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
      }

      .btn:disabled {
        background: #ccc;
        cursor: not-allowed;
        transform: none;
      }

      .progress-section {
        display: none;
      }

      .user-info {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 25px;
        border-radius: 15px;
        margin-bottom: 25px;
        color: white;
      }

      .user-info h2 {
        font-size: 22px;
        margin-bottom: 15px;
      }

      .user-info .info-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      .user-info .info-item {
        background: rgba(255, 255, 255, 0.2);
        padding: 12px;
        border-radius: 10px;
      }

      .user-info .label {
        font-size: 12px;
        opacity: 0.9;
        margin-bottom: 5px;
      }

      .user-info .value {
        font-size: 16px;
        font-weight: bold;
      }

      .status-badge {
        display: inline-block;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 13px;
        font-weight: bold;
        background: white;
      }

      .alert {
        padding: 18px;
        border-radius: 12px;
        margin-bottom: 25px;
        font-size: 15px;
        line-height: 1.6;
      }

      .alert-info {
        background: #e3f2fd;
        color: #0d47a1;
        border-left: 5px solid #2196f3;
      }

      .alert-success {
        background: #e8f5e9;
        color: #1b5e20;
        border-left: 5px solid #4caf50;
      }

      .alert-warning {
        background: #fff3e0;
        color: #e65100;
        border-left: 5px solid #ff9800;
      }

      .timeline {
        position: relative;
        padding: 20px 0;
      }

      .timeline::before {
        content: "";
        position: absolute;
        left: 20px;
        top: 0;
        bottom: 0;
        width: 3px;
        background: linear-gradient(180deg, #667eea 0%, #e9ecef 100%);
      }

      .timeline-step {
        position: relative;
        padding-left: 60px;
        margin-bottom: 35px;
        opacity: 0.5;
        transition: opacity 0.3s;
      }

      .timeline-step.active,
      .timeline-step.completed {
        opacity: 1;
      }

      .timeline-step .step-circle {
        position: absolute;
        left: 8px;
        top: 0;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: #e9ecef;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: bold;
        color: #999;
        border: 3px solid white;
        z-index: 1;
      }

      .timeline-step.active .step-circle {
        background: #667eea;
        color: white;
        box-shadow: 0 0 0 6px rgba(102, 126, 234, 0.2);
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          box-shadow: 0 0 0 6px rgba(102, 126, 234, 0.2);
        }
        50% {
          box-shadow: 0 0 0 10px rgba(102, 126, 234, 0.1);
        }
      }

      .timeline-step.completed .step-circle {
        background: #4caf50;
        color: white;
      }

      .timeline-step.completed .step-circle::after {
        content: "âœ“";
      }

      .step-content {
        background: #f8f9fa;
        padding: 22px;
        border-radius: 12px;
        border-left: 4px solid #e9ecef;
      }

      .timeline-step.active .step-content {
        background: white;
        border-left-color: #667eea;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
      }

      .timeline-step.completed .step-content {
        border-left-color: #4caf50;
      }

      .step-title {
        font-size: 17px;
        font-weight: bold;
        color: #333;
        margin-bottom: 12px;
      }

      .step-description {
        font-size: 14px;
        color: #666;
        margin-bottom: 16px;
        line-height: 1.7;
      }

      .checklist {
        margin: 16px 0;
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
      }

      .checklist-item {
        display: flex;
        align-items: center;
        padding: 10px;
        font-size: 14px;
        color: #333;
        border-radius: 6px;
        margin-bottom: 8px;
        transition: background 0.2s;
      }

      .checklist-item:hover {
        background: white;
      }

      .checklist-item input[type="checkbox"] {
        margin-right: 12px;
        width: 20px;
        height: 20px;
        cursor: pointer;
      }

      .action-button {
        margin-top: 18px;
      }

      .guide-link {
        display: inline-flex;
        align-items: center;
        color: #667eea;
        text-decoration: none;
        font-size: 14px;
        margin-top: 12px;
        font-weight: 600;
        padding: 8px 0;
      }

      .guide-link:hover {
        text-decoration: underline;
      }

      .help-section {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        padding: 25px;
        border-radius: 15px;
        margin-top: 25px;
        text-align: center;
      }

      .help-section h3 {
        font-size: 18px;
        color: #333;
        margin-bottom: 12px;
      }

      .help-section p {
        font-size: 14px;
        color: #666;
        line-height: 1.6;
        margin-bottom: 15px;
      }

      .contact-button {
        display: inline-block;
        padding: 12px 30px;
        background: #667eea;
        color: white;
        text-decoration: none;
        border-radius: 10px;
        font-size: 15px;
        font-weight: 600;
        transition: all 0.3s;
      }

      .contact-button:hover {
        background: #5568d3;
        transform: translateY(-2px);
      }

      .loading {
        text-align: center;
        padding: 50px;
        color: #666;
      }

      .loading-spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 15px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .logout-button {
        background: #6c757d;
        padding: 12px;
        font-size: 14px;
        margin-top: 15px;
      }

      .error-message {
        text-align: center;
        color: #dc3545;
        padding: 20px;
        font-size: 15px;
        background: #ffe6e6;
        border-radius: 10px;
        margin: 15px 0;
      }

      .collection-progress {
        background: #e3f2fd;
        padding: 20px;
        border-radius: 12px;
        margin: 15px 0;
      }

      .collection-progress .days-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 8px;
        margin-top: 12px;
      }

      .collection-progress .day-box {
        aspect-ratio: 1;
        background: white;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
        color: #999;
        border: 2px solid #e9ecef;
      }

      .collection-progress .day-box.completed {
        background: #4caf50;
        color: white;
        border-color: #4caf50;
      }

      .collection-progress .day-box.current {
        background: #667eea;
        color: white;
        border-color: #667eea;
        animation: bounce 2s infinite;
      }

      @keyframes bounce {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- ë¡œê·¸ì¸ ì¹´ë“œ -->
      <div class="card" id="login-card">
        <div class="header">
          <h1>ğŸŒ™ ìˆ˜ë©´ ë°ì´í„° ìˆ˜ì§‘</h1>
          <p class="subtitle">ì°¸ê°€ì ì§„í–‰ í˜„í™© í˜ì´ì§€</p>
        </div>

        <div class="input-group">
          <label for="participant-id">ì°¸ê°€ì ID</label>
          <input
            type="text"
            id="participant-id"
            placeholder="ì˜ˆ: 0001"
            maxlength="4"
            pattern="[0-9]{4}"
            inputmode="numeric"
          />
        </div>
        <div class="input-group">
          <label for="participant-name">ì´ë¦„</label>
          <input type="text" id="participant-name" placeholder="í™ê¸¸ë™" />
        </div>
        <button class="btn" onclick="login()" id="login-btn">ë¡œê·¸ì¸</button>
        <p
          style="
            text-align: center;
            margin-top: 15px;
            font-size: 13px;
            color: #666;
          "
        >
          ğŸ’¬ ì°¸ê°€ì IDëŠ” ë¬¸ìë¥¼ í†µí•´ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.
        </p>
        <div id="login-error" class="error-message" style="display: none"></div>
      </div>

      <!-- ì§„í–‰ í˜„í™© ì¹´ë“œ -->
      <div class="card progress-section" id="progress-card">
        <div class="header">
          <h1>ë‚˜ì˜ ì§„í–‰ í˜„í™©</h1>
        </div>

        <div class="user-info" id="user-info">
          <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
        </div>

        <div id="current-alert" style="display: none">
          <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
        </div>

        <div class="timeline" id="timeline">
          <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
        </div>

        <div class="help-section">
          <h3>â“ ë„ì›€ì´ í•„ìš”í•˜ì‹ ê°€ìš”?</h3>
          <p>
            ê¸°ê¸° ì—°ë™ì´ ì•ˆ ë˜ê±°ë‚˜ ë¬¸ì œê°€ ë°œìƒí•˜ë©´<br />ì–¸ì œë“  ì—°ë½ì£¼ì„¸ìš”. ë¹ ë¥´ê²Œ
            ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤!
          </p>
          <p
            style="
              font-size: 16px;
              font-weight: 600;
              color: #667eea;
              margin-top: 15px;
              line-height: 1.8;
            "
          >
            ğŸ“ ìŠ¬ë™ ì±„ë„ì—ì„œ ë¬¸ì˜<br />
            <span style="font-size: 14px; color: #666"
              >(ê¸‰í•œ ê²½ìš° 010-4343-4195)</span
            >
          </p>
        </div>

        <button class="btn logout-button" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
      </div>
    </div>

    <script>
      // ===== ì„¤ì • =====
      const SCRIPT_URL =
        "https://script.google.com/macros/s/AKfycbxkaLKygRzsMeWkqcZPmUqndmHtkAMcgl_yKOmrjsv0iDgxSiRct_LMehBg7w2c_QfJIQ/exec";
      let currentUser = null;

      // ===== ë¡œê·¸ì¸ =====
      async function login() {
        const id = document.getElementById("participant-id").value.trim();
        const name = document.getElementById("participant-name").value.trim();

        if (!id || !name) {
          showError("login-error", "ì°¸ê°€ì IDì™€ ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
          return;
        }

        // ì°¸ê°€ì ID ìœ íš¨ì„± ê²€ì‚¬ (ìˆ«ì 4ìë¦¬)
        if (!/^\d{4}$/.test(id)) {
          showError(
            "login-error",
            "ì°¸ê°€ì IDëŠ” ìˆ«ì 4ìë¦¬ì—¬ì•¼ í•©ë‹ˆë‹¤. (ì˜ˆ: 0001)"
          );
          return;
        }

        const btn = document.getElementById("login-btn");
        btn.disabled = true;
        btn.textContent = "ë¡œê·¸ì¸ ì¤‘...";

        try {
          const response = await fetch(SCRIPT_URL, {
            method: "POST",
            headers: { "Content-Type": "text/plain" },
            body: JSON.stringify({
              action: "getParticipant",
              id: id,
              name: name,
            }),
          });

          const result = await response.json();

          if (result.success) {
            currentUser = result.data;
            showProgress(result.data);
            document.getElementById("login-error").style.display = "none";
          } else {
            showError("login-error", result.message);
          }
        } catch (error) {
          showError(
            "login-error",
            "ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."
          );
          console.error(error);
        } finally {
          btn.disabled = false;
          btn.textContent = "ë¡œê·¸ì¸";
        }
      }

      // ===== ì§„í–‰ í˜„í™© í‘œì‹œ =====
      function showProgress(data) {
        document.getElementById("login-card").style.display = "none";
        document.getElementById("progress-card").style.display = "block";

        // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
        renderUserInfo(data);

        // í˜„ì¬ ìƒíƒœ ì•Œë¦¼
        renderCurrentAlert(data);

        // íƒ€ì„ë¼ì¸ ë Œë”ë§
        renderTimeline(data);
      }

      // ===== ì‚¬ìš©ì ì •ë³´ ë Œë”ë§ =====
      function renderUserInfo(data) {
        const statusColor = getStatusColor(data.status);

        document.getElementById("user-info").innerHTML = `
                <h2>${data.name}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‘‹</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <div class="label">ì°¸ê°€ì ID</div>
                        <div class="value">${data.id}</div>
                    </div>
                    <div class="info-item">
                        <div class="label">ë°°ì • ê¸°ê¸°</div>
                        <div class="value">${data.device}</div>
                    </div>
                    <div class="info-item">
                        <div class="label">í˜„ì¬ ìƒíƒœ</div>
                        <div class="value"><span class="status-badge" style="color: ${statusColor}">${
          data.status
        }</span></div>
                    </div>
                    <div class="info-item">
                        <div class="label">${
                          data.status === "ìˆ˜ì§‘ì¤‘" ? "ì¸¡ì • ìƒíƒœ" : "ì§„í–‰ ê²½ê³¼"
                        }</div>
                        <div class="value">${
                          data.status === "ìˆ˜ì§‘ì¤‘"
                            ? data.collectDays >= 1
                              ? "ì™„ë£Œ"
                              : "ëŒ€ê¸°ì¤‘"
                            : data.daysElapsed + "ì¼"
                        }</div>
                    </div>
                </div>
            `;
      }

      // ===== í˜„ì¬ ìƒíƒœ ì•Œë¦¼ ë Œë”ë§ =====
      function renderCurrentAlert(data) {
        const alertDiv = document.getElementById("current-alert");
        const alerts = {
          ëŒ€ê¸°ì¤‘: {
            type: "info",
            message:
              "ìŠ¬ë™ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ì°¸ì—¬í•˜ì…¨ë‚˜ìš”? ë¬¸ìë¡œ ë°›ì€ ì´ˆëŒ€ ë§í¬ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”!",
          },
          ìŠ¬ë™ì°¸ì—¬: {
            type: "info",
            message: "ìŠ¬ë™ ì°¸ì—¬ ì™„ë£Œ! ê³§ ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ê°€ ë°œì†¡ë  ì˜ˆì •ì…ë‹ˆë‹¤.",
          },
          ë°œì†¡ì™„ë£Œ: {
            type: "warning",
            message:
              "ğŸ“¦ ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ê°€ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤. íƒë°°ë¥¼ ë°›ìœ¼ì‹œë©´ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.",
          },
          ìˆ˜ë ¹í™•ì¸í•„ìš”: {
            type: "warning",
            message: "âš ï¸ íƒë°°ê°€ ë„ì°©í–ˆì„ ì˜ˆì •ì…ë‹ˆë‹¤. ìˆ˜ë ¹í•˜ì…¨ë‚˜ìš”?",
          },
          ìˆ˜ë ¹ì™„ë£Œ: {
            type: "info",
            message: "ğŸ“± ì´ì œ ì•±ì„ ì„¤ì¹˜í•˜ê³  ê¸°ê¸°ë¥¼ ì—°ë™í•´ì£¼ì„¸ìš”.",
          },
          ì—°ë™ëŒ€ê¸°: {
            type: "warning",
            message:
              "âš ï¸ ì•„ì§ ê¸°ê¸° ì—°ë™ì´ í™•ì¸ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ê°€ì´ë“œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",
          },
          ìˆ˜ì§‘ì¤‘: {
            type: "warning",
            message: data.collectStartDate
              ? `ğŸ˜´ ì¸¡ì • ì˜ˆì •ì¼: ${data.collectStartDate}. í•´ë‹¹ ë‚ ì§œì— ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ë¥¼ ì°©ìš©í•˜ê³  ì£¼ë¬´ì„¸ìš”.`
              : `âš ï¸ ì—°ë™ ì™„ë£Œ! 1-2ì¼ ë‚´ì— ì¸¡ì • ë¶€íƒë“œë¦¬ë©°, ì¶”ê°€ ì‹œê°„ì´ í•„ìš”í•œ ê²½ìš° ë§¤ë‹ˆì €ì—ê²Œ ì•Œë ¤ì£¼ì„¸ìš”. (ğŸ“ 010-4343-4195)`,
          },
          ìˆ˜ì§‘ì™„ë£Œ: {
            type: "success",
            message:
              "ğŸ‰ ì¸¡ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ ì•±ì—ì„œ ë°ì´í„°ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",
          },
          ë°ì´í„°í™•ì¸ì¤‘: {
            type: "info",
            message:
              "ğŸ“Š ì•±ì—ì„œ ìˆ˜ë©´ ë°ì´í„°ê°€ 4ë‹¨ê³„ë¡œ ê¸°ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.",
          },
          ë°ì´í„°ì œì¶œëŒ€ê¸°: {
            type: "warning",
            message: "ğŸ“¤ ê°€ì´ë“œë¥¼ ë”°ë¼ ë°ì´í„°ë¥¼ ì´ë©”ì¼ë¡œ ì œì¶œí•´ì£¼ì„¸ìš”.",
          },
          ë§¤ë‹ˆì €í™•ì¸ì¤‘: {
            type: "info",
            message: "â³ ë§¤ë‹ˆì €ê°€ ë°ì´í„°ë¥¼ í™•ì¸ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.",
          },
        };

        const alert = alerts[data.status] || {
          type: "info",
          message: "ìƒíƒœë¥¼ í™•ì¸ ì¤‘ì…ë‹ˆë‹¤.",
        };

        alertDiv.className = "alert alert-" + alert.type;
        alertDiv.innerHTML = alert.message;
        alertDiv.style.display = "block";
      }

      // ===== íƒ€ì„ë¼ì¸ ë Œë”ë§ =====
      function renderTimeline(data) {
        const timeline = document.getElementById("timeline");
        const steps = getTimelineSteps(data);

        timeline.innerHTML = steps
          .map(
            (step, index) => `
                <div class="timeline-step ${step.state}" data-step="${
              index + 1
            }">
                    <div class="step-circle">${
                      step.state === "completed" || step.state === "active"
                        ? ""
                        : index + 1
                    }</div>
                    <div class="step-content">
                        <div class="step-title">${step.title}</div>
                        <div class="step-description">${step.description}</div>
                        ${step.content || ""}
                    </div>
                </div>
            `
          )
          .join("");
      }

      // ===== íƒ€ì„ë¼ì¸ ë‹¨ê³„ ìƒì„± =====
      function getTimelineSteps(data) {
        const currentStep = getStepNumber(data.status);

        return [
          {
            state: currentStep >= 1 ? "completed" : "",
            title: "1ë‹¨ê³„: ì°¸ê°€ í™•ì • & ìŠ¬ë™ ì°¸ì—¬",
            description:
              "í”„ë¡œì íŠ¸ ì°¸ê°€ê°€ í™•ì •ë˜ì—ˆìŠµë‹ˆë‹¤. ìŠ¬ë™ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ì°¸ì—¬í•´ì£¼ì„¸ìš”.",
            content:
              currentStep === 1
                ? `
                        <div class="alert alert-info">
                            ğŸ“± ìŠ¬ë™(Slack) ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ì´ˆëŒ€ë˜ì…¨ìŠµë‹ˆë‹¤.<br>
                            ë¬¸ìë¡œ ë°›ìœ¼ì‹  ì´ˆëŒ€ ë§í¬ë¥¼ í†µí•´ ì°¸ì—¬í•´ì£¼ì„¸ìš”.
                        </div>
                        <div class="checklist">
                            <div class="checklist-item">
                                <input type="checkbox" id="check-slack-join">
                                <label for="check-slack-join">ìŠ¬ë™ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ì°¸ì—¬í–ˆìŠµë‹ˆë‹¤</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="check-slack-check">
                                <label for="check-slack-check">ê³µì§€ì‚¬í•­ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤</label>
                            </div>
                        </div>
                        <p style="font-size: 13px; color: #666; margin-top: 10px;">
                            ğŸ’¡ ìŠ¬ë™ì—ì„œ ì‹¤ì‹œê°„ ê³µì§€ì™€ ë¬¸ì˜ì‘ë‹µì„ ë°›ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </p>
                    `
                : "",
          },
          {
            state:
              currentStep > 2 ? "completed" : currentStep === 2 ? "active" : "",
            title: "2ë‹¨ê³„: íƒë°° ìˆ˜ë ¹ ëŒ€ê¸°",
            description: data.shipDate
              ? `ë°œì†¡ì¼: ${data.shipDate}`
              : "ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ê°€ ê³§ ë°œì†¡ë©ë‹ˆë‹¤.",
            content:
              currentStep === 2
                ? `
                        <div class="checklist">
                            <div class="checklist-item">
                                <input type="checkbox" id="check-received">
                                <label for="check-received">íƒë°°ë¥¼ ìˆ˜ë ¹í–ˆìŠµë‹ˆë‹¤</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="check-contents">
                                <label for="check-contents">ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ì™€ ì¶©ì „ê¸°ê°€ ëª¨ë‘ ë“¤ì–´ìˆìŠµë‹ˆë‹¤</label>
                            </div>
                        </div>
                        <div class="action-button">
                            <button class="btn" onclick="updateStatus('ìˆ˜ë ¹ì™„ë£Œ')">âœ“ ìˆ˜ë ¹ ì™„ë£Œ ì•Œë¦¬ê¸°</button>
                        </div>
                    `
                : "",
          },
          {
            state:
              currentStep > 3 ? "completed" : currentStep === 3 ? "active" : "",
            title: "3ë‹¨ê³„: ì•± ì„¤ì¹˜ ë° ê¸°ê¸° ì—°ë™",
            description: "ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ ì•±ì„ ì„¤ì¹˜í•˜ê³  ê¸°ê¸°ë¥¼ ì—°ë™í•´ì£¼ì„¸ìš”.",
            content:
              currentStep === 3
                ? `
                        <a href="#" class="guide-link" onclick="openGuide('app'); return false;">ğŸ“± ì•± ì„¤ì¹˜ ê°€ì´ë“œ ë³´ê¸° â†’</a>
                        <div class="checklist">
                            <div class="checklist-item">
                                <input type="checkbox" id="check-app-install">
                                <label for="check-app-install">ì•±ì„ ì„¤ì¹˜í–ˆìŠµë‹ˆë‹¤</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="check-device-sync">
                                <label for="check-device-sync">ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ì™€ ì—°ë™í–ˆìŠµë‹ˆë‹¤</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="check-data-visible">
                                <label for="check-data-visible">ì•±ì—ì„œ ìˆ˜ë©´ ë°ì´í„°ê°€ ë³´ì…ë‹ˆë‹¤</label>
                            </div>
                        </div>
                        <div class="action-button">
                            <button class="btn" onclick="updateStatus('ìˆ˜ì§‘ì¤‘')">âœ“ ì—°ë™ ì™„ë£Œ ì•Œë¦¬ê¸°</button>
                        </div>
                    `
                : "",
          },
          {
            state:
              currentStep > 4 ? "completed" : currentStep === 4 ? "active" : "",
            title: "4ë‹¨ê³„: ë°ì´í„° ì¸¡ì • (1ì¼)",
            description: `ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ë¥¼ ì°©ìš©í•˜ê³  í•˜ë£¨ ë°¤ ìˆ˜ë©´ì„ ì¸¡ì •í•´ì£¼ì„¸ìš”.${
              data.collectStartDate
                ? "<br><strong>ì¸¡ì • ì˜ˆì •ì¼: " +
                  data.collectStartDate +
                  "</strong>"
                : "<br><span style='color: #ff6b6b;'>âš ï¸ ì—°ë™ í›„ 1-2ì¼ ë‚´ ì¸¡ì • ë¶€íƒë“œë¦½ë‹ˆë‹¤!</span>"
            }`,
            content:
              currentStep === 4
                ? `
                        <div class="alert alert-warning" style="margin-bottom: 20px;">
                            â° ì—°ë™ ì™„ë£Œ í›„ 1-2ì¼ ë‚´ì— ì¸¡ì • ë¶€íƒë“œë¦¬ë©°,<br>
                            ì¶”ê°€ ì‹œê°„ì´ í•„ìš”í•œ ê²½ìš° ë§¤ë‹ˆì €ì—ê²Œ ì—°ë½ì£¼ì„¸ìš”.<br>
                            ğŸ“ 010-4343-4195
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                            <label style="display: block; font-weight: bold; margin-bottom: 10px; color: #333;">
                                ğŸ“… ì¸¡ì • ì˜ˆì •ì¼ ì„ íƒ
                            </label>
                            <input type="date" id="measure-date" 
                                   value="${data.collectStartDate || ""}"
                                   style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px;">
                            <button class="btn" onclick="updateMeasureDate()" 
                                    style="margin-top: 12px; background: #2196f3;">
                                ğŸ“… ì¸¡ì •ì¼ ${
                                  data.collectStartDate ? "ë³€ê²½" : "ì„¤ì •"
                                }í•˜ê¸°
                            </button>
                        </div>

                        ${
                          data.collectStartDate
                            ? `
                            <div class="collection-progress">
                                <div style="text-align: center; font-weight: bold; color: #1976d2; margin-bottom: 8px;">
                                    ì¸¡ì • ìƒíƒœ: ${
                                      data.collectDays >= 1
                                        ? "âœ… ì™„ë£Œ"
                                        : "â³ ëŒ€ê¸°ì¤‘"
                                    }
                                </div>
                                <div style="text-align: center; padding: 20px; background: white; border-radius: 10px;">
                                    <div style="font-size: 48px; margin-bottom: 10px;">
                                        ${data.collectDays >= 1 ? "âœ…" : "ğŸ˜´"}
                                    </div>
                                    <div style="font-size: 16px; color: #666;">
                                        ${
                                          data.collectDays >= 1
                                            ? "ì¸¡ì • ì™„ë£Œ!"
                                            : "ì¸¡ì • ì˜ˆì •ì¼: " +
                                              data.collectStartDate
                                        }
                                    </div>
                                </div>
                            </div>
                            <a href="#" class="guide-link" onclick="openGuide('check'); return false;">ğŸ” ë°ì´í„° í™•ì¸ ë°©ë²• ë³´ê¸° â†’</a>
                        `
                            : ""
                        }

                        ${
                          data.collectDays >= 1
                            ? `
                            <div class="action-button">
                                <button class="btn" onclick="updateStatus('ìˆ˜ì§‘ì™„ë£Œ')">âœ“ ì¸¡ì • ì™„ë£Œ ì•Œë¦¬ê¸°</button>
                            </div>
                        `
                            : ""
                        }
                    `
                : "",
          },
          {
            state:
              currentStep > 5 ? "completed" : currentStep === 5 ? "active" : "",
            title: "5ë‹¨ê³„: ë°ì´í„° í™•ì¸",
            description:
              "ì¸¡ì • ë‹¹ì¼ì— ì•±ì— ìˆ˜ë©´ ë°ì´í„°ê°€ 4ë‹¨ê³„ë¡œ ê¸°ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.",
            content:
              currentStep === 5
                ? `
                        <div class="alert alert-info" style="margin-bottom: 20px;">
                            ğŸ“± ì•±ì„ ì—´ì–´ ì¸¡ì • ë‹¹ì¼ì˜ ìˆ˜ë©´ ë°ì´í„°ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.<br>
                            ìˆ˜ë©´ ë‹¨ê³„ê°€ 4ë‹¨ê³„(ê¹Šì€ìˆ˜ë©´, ì–•ì€ìˆ˜ë©´, REMìˆ˜ë©´, ê¹¨ì–´ìˆìŒ)ë¡œ í‘œì‹œë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
                        </div>
                        
                        <a href="https://docs.google.com/presentation/d/1UvG6Vl1lWJlcOITc3KmaJboFYnmo1FDiJ-nk9qrsrH8/edit?slide=id.g37e30063af9_0_231#slide=id.g37e30063af9_0_231" 
                           class="guide-link" 
                           target="_blank"
                           style="display: block; margin-bottom: 20px;">
                            ğŸ” ë°ì´í„° í™•ì¸ ë°©ë²• ë³´ê¸° â†’
                        </a>

                        <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                            <label style="display: block; font-weight: bold; margin-bottom: 15px; color: #333;">
                                ğŸ“Š ì•±ì— ë°ì´í„°ê°€ 4ë‹¨ê³„ë¡œ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆê¹Œ?
                            </label>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn" onclick="handleDataCheck('yes')" 
                                        style="flex: 1; background: #4caf50;">
                                    âœ… ë„¤, 4ë‹¨ê³„ë¡œ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤
                                </button>
                                <button class="btn" onclick="handleDataCheck('no')" 
                                        style="flex: 1; background: #ff6b6b;">
                                    âŒ ì•„ë‹ˆì˜¤, ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤
                                </button>
                            </div>
                        </div>
                    `
                : "",
          },
          {
            state:
              currentStep > 6 ? "completed" : currentStep === 6 ? "active" : "",
            title: "6ë‹¨ê³„: ë°ì´í„° ì œì¶œ",
            description: "ê°€ì´ë“œë¥¼ ë”°ë¼ ìˆ˜ë©´ ë°ì´í„°ë¥¼ ì´ë©”ì¼ë¡œ ì œì¶œí•´ì£¼ì„¸ìš”.",
            content:
              currentStep === 6
                ? `
                        <div class="alert alert-warning" style="margin-bottom: 20px;">
                            ğŸ“¤ ì•„ë˜ ê°€ì´ë“œë¥¼ ë”°ë¼ ë°ì´í„°ë¥¼ ì´ë©”ì¼ë¡œ ì œì¶œí•´ì£¼ì„¸ìš”.
                        </div>
                        
                        <a href="https://docs.google.com/presentation/d/1UvG6Vl1lWJlcOITc3KmaJboFYnmo1FDiJ-nk9qrsrH8/edit?slide=id.g37e30063af9_0_231#slide=id.g37e30063af9_0_231" 
                           class="guide-link" 
                           target="_blank"
                           style="display: block; font-size: 16px; padding: 15px; background: white; border-radius: 10px; margin-bottom: 20px;">
                            ğŸ“„ ë°ì´í„° ì œì¶œ ê°€ì´ë“œ ë³´ê¸° â†’
                        </a>

                        <div class="checklist">
                            <div class="checklist-item">
                                <input type="checkbox" id="check-guide-read">
                                <label for="check-guide-read">ê°€ì´ë“œë¥¼ ì½ì—ˆìŠµë‹ˆë‹¤</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="check-data-submitted">
                                <label for="check-data-submitted">ë°ì´í„°ë¥¼ ì´ë©”ì¼ë¡œ ì œì¶œí–ˆìŠµë‹ˆë‹¤</label>
                            </div>
                        </div>
                        
                        <div class="action-button">
                            <button class="btn" onclick="updateStatus('ë°ì´í„°ì œì¶œì™„ë£Œ')">âœ“ ì œì¶œ ì™„ë£Œ ì•Œë¦¬ê¸°</button>
                        </div>
                    `
                : "",
          },
          {
            state:
              currentStep > 7 ? "completed" : currentStep === 7 ? "active" : "",
            title: "7ë‹¨ê³„: ë§¤ë‹ˆì € ë°ì´í„° í™•ì¸",
            description: "ë§¤ë‹ˆì €ê°€ ì œì¶œí•˜ì‹  ë°ì´í„°ë¥¼ í™•ì¸í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
            content:
              currentStep === 7
                ? `
                        <div class="alert alert-info" style="margin-bottom: 20px;">
                            â³ ë§¤ë‹ˆì €ê°€ ë°ì´í„°ë¥¼ ê²€í†  ì¤‘ì…ë‹ˆë‹¤.<br>
                            í™•ì¸ì´ ì™„ë£Œë˜ë©´ ìë™ìœ¼ë¡œ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.
                        </div>
                        
                        <div style="text-align: center; padding: 40px; background: white; border-radius: 12px;">
                            <div style="font-size: 60px; margin-bottom: 15px;">â°</div>
                            <div style="font-size: 18px; font-weight: bold; color: #333; margin-bottom: 10px;">
                                ë°ì´í„° ê²€í†  ì¤‘
                            </div>
                            <div style="font-size: 14px; color: #666;">
                                ë³´í†µ 1-2ì¼ ì´ë‚´ì— í™•ì¸ì´ ì™„ë£Œë©ë‹ˆë‹¤.
                            </div>
                        </div>
                        
                        <p style="font-size: 13px; color: #666; margin-top: 15px; text-align: center;">
                            ğŸ’¬ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ìŠ¬ë™ ì±„ë„ì— ë‚¨ê²¨ì£¼ì„¸ìš”.
                        </p>
                    `
                : "",
          },
          {
            state:
              currentStep > 8 ? "completed" : currentStep === 8 ? "active" : "",
            title: "8ë‹¨ê³„: ê¸°ê¸° ë°˜ë‚© ì¤€ë¹„",
            description: `ë°ì´í„° ì¸¡ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!${
              data.pickupDate && data.pickupDate !== "ì¡°ìœ¨ ì¤‘"
                ? "<br><strong>íšŒìˆ˜ ì˜ˆì •ì¼: " + data.pickupDate + "</strong>"
                : "<br>ê³§ íƒë°° íšŒìˆ˜ ì¼ì •ì„ ì•ˆë‚´í•´ë“œë¦½ë‹ˆë‹¤."
            }`,
            content:
              currentStep === 5
                ? `
                        <div class="checklist">
                            <div class="checklist-item">
                                <input type="checkbox" id="check-packed">
                                <label for="check-packed">ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ì™€ ì¶©ì „ê¸°ë¥¼ ë°•ìŠ¤ì— ë‹´ì•˜ìŠµë‹ˆë‹¤</label>
                            </div>
                            <div class="checklist-item">
                                <input type="checkbox" id="check-ready">
                                <label for="check-ready">íƒë°° ê¸°ì‚¬ë‹˜ ë°©ë¬¸ ì¤€ë¹„ ì™„ë£Œ</label>
                            </div>
                        </div>
                    `
                : "",
          },
          {
            state: currentStep >= 9 ? "completed" : "",
            title: "ì™„ë£Œ! ğŸ‰",
            description:
              "ë°ì´í„° ìˆ˜ì§‘ í”„ë¡œì íŠ¸ì— ì°¸ì—¬í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!<br>ê·€í•˜ì˜ ë°ì´í„°ëŠ” ìˆ˜ë©´ ì—°êµ¬ì— í° ë„ì›€ì´ ë  ê²ƒì…ë‹ˆë‹¤.",
            content:
              currentStep >= 9
                ? `
                        <div class="alert alert-success">
                            âœ… ëª¨ë“  ë‹¨ê³„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì†Œì •ì˜ ì°¸ê°€ë¹„ëŠ” 2-3ì¼ ë‚´ë¡œ ì§€ê¸‰ë©ë‹ˆë‹¤.
                        </div>
                    `
                : "",
          },
        ];
      }

      // ===== ë°ì´í„° í™•ì¸ ì²˜ë¦¬ =====
      async function handleDataCheck(answer) {
        if (!currentUser) return;

        if (answer === "no") {
          alert(
            "âŒ ë°ì´í„° ê¸°ë¡ì— ë¬¸ì œê°€ ìˆëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.\nìŠ¬ë™ ì±„ë„ì— ë¬¸ì˜í•´ì£¼ì„¸ìš”.\n\nê¸‰í•œ ê²½ìš°: 010-4343-4195"
          );
          return;
        }

        if (!confirm("ì•±ì— ë°ì´í„°ê°€ 4ë‹¨ê³„ë¡œ ì •ìƒ ê¸°ë¡ëœ ê²ƒì„ í™•ì¸í•˜ì…¨ë‚˜ìš”?")) {
          return;
        }

        try {
          const response = await fetch(SCRIPT_URL, {
            method: "POST",
            headers: { "Content-Type": "text/plain" },
            body: JSON.stringify({
              action: "updateStatus",
              id: currentUser.id,
              status: "ë°ì´í„°í™•ì¸ì™„ë£Œ",
            }),
          });

          const result = await response.json();

          if (result.success) {
            alert(
              "âœ… ë°ì´í„° í™•ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ ë°ì´í„°ë¥¼ ì œì¶œí•´ì£¼ì„¸ìš”."
            );
            await refreshData();
          } else {
            alert("âŒ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: " + result.message);
          }
        } catch (error) {
          alert("âŒ ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
          console.error(error);
        }
      }

      // ===== ìƒíƒœë³„ ë‹¨ê³„ ë²ˆí˜¸ =====
      function getStepNumber(status) {
        const steps = {
          ëŒ€ê¸°ì¤‘: 1,
          ìŠ¬ë™ì°¸ì—¬: 1,
          ë°œì†¡ì™„ë£Œ: 2,
          ìˆ˜ë ¹í™•ì¸í•„ìš”: 2,
          ìˆ˜ë ¹ì™„ë£Œ: 3,
          ì—°ë™ëŒ€ê¸°: 3,
          ìˆ˜ì§‘ì¤‘: 4,
          ìˆ˜ì§‘ì™„ë£Œ: 5,
          ë°ì´í„°í™•ì¸ì™„ë£Œ: 6,
          ë°ì´í„°ì œì¶œì™„ë£Œ: 7,
          ë§¤ë‹ˆì €í™•ì¸ì™„ë£Œ: 8,
          íšŒìˆ˜ëŒ€ê¸°: 8,
          íšŒìˆ˜ì™„ë£Œ: 9,
        };
        return steps[status] || 1;
      }

      // ===== ìƒíƒœ ì—…ë°ì´íŠ¸ =====
      async function updateStatus(newStatus) {
        if (!currentUser) return;

        // ì²´í¬ë¦¬ìŠ¤íŠ¸ í™•ì¸
        if (!validateChecklist(newStatus)) {
          alert("âœ‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ëª¨ë‘ ì™„ë£Œí•´ì£¼ì„¸ìš”.");
          return;
        }

        if (!confirm(`ìƒíƒœë¥¼ '${newStatus}'ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
          return;
        }

        // ë²„íŠ¼ ë¹„í™œì„±í™”
        const buttons = document.querySelectorAll(".btn");
        buttons.forEach((btn) => (btn.disabled = true));

        try {
          const response = await fetch(SCRIPT_URL, {
            method: "POST",
            headers: { "Content-Type": "text/plain" },
            body: JSON.stringify({
              action: "updateStatus",
              id: currentUser.id,
              status: newStatus,
            }),
          });

          const result = await response.json();

          if (result.success) {
            alert("âœ… ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤!");
            // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
            await refreshData();
          } else {
            alert("âŒ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: " + result.message);
          }
        } catch (error) {
          alert("âŒ ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
          console.error(error);
        } finally {
          buttons.forEach((btn) => (btn.disabled = false));
        }
      }

      // ===== ë°ì´í„° ìƒˆë¡œê³ ì¹¨ =====
      async function refreshData() {
        try {
          const response = await fetch(SCRIPT_URL, {
            method: "POST",
            headers: { "Content-Type": "text/plain" },
            body: JSON.stringify({
              action: "getParticipant",
              id: currentUser.id,
              name: currentUser.name,
            }),
          });

          const result = await response.json();
          if (result.success) {
            currentUser = result.data;
            showProgress(result.data);
          }
        } catch (error) {
          console.error(error);
        }
      }

      // ===== ì¸¡ì •ì¼ ì—…ë°ì´íŠ¸ =====
      async function updateMeasureDate() {
        if (!currentUser) return;

        const dateInput = document.getElementById("measure-date");
        const selectedDate = dateInput.value;

        if (!selectedDate) {
          alert("ğŸ“… ì¸¡ì • ì˜ˆì •ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
          return;
        }

        if (!confirm(`ì¸¡ì • ì˜ˆì •ì¼ì„ ${selectedDate}ë¡œ ì„¤ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
          return;
        }

        try {
          const response = await fetch(SCRIPT_URL, {
            method: "POST",
            headers: { "Content-Type": "text/plain" },
            body: JSON.stringify({
              action: "updateMeasureDate",
              id: currentUser.id,
              date: selectedDate,
            }),
          });

          const result = await response.json();

          if (result.success) {
            alert("âœ… ì¸¡ì • ì˜ˆì •ì¼ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!");
            await refreshData();
          } else {
            alert("âŒ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: " + result.message);
          }
        } catch (error) {
          alert("âŒ ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
          console.error(error);
        }
      }

      // ===== ì²´í¬ë¦¬ìŠ¤íŠ¸ ê²€ì¦ =====
      function validateChecklist(status) {
        if (status === "ìˆ˜ë ¹ì™„ë£Œ") {
          const check1 = document.getElementById("check-received");
          const check2 = document.getElementById("check-contents");
          return check1 && check2 && check1.checked && check2.checked;
        }
        if (status === "ìˆ˜ì§‘ì¤‘") {
          const check1 = document.getElementById("check-app-install");
          const check2 = document.getElementById("check-device-sync");
          const check3 = document.getElementById("check-data-visible");
          return (
            check1 &&
            check2 &&
            check3 &&
            check1.checked &&
            check2.checked &&
            check3.checked
          );
        }
        if (status === "ë°ì´í„°ì œì¶œì™„ë£Œ") {
          const check1 = document.getElementById("check-guide-read");
          const check2 = document.getElementById("check-data-submitted");
          return check1 && check2 && check1.checked && check2.checked;
        }
        return true;
      }

      // ===== ê°€ì´ë“œ ì—´ê¸° =====
      function openGuide(type) {
        // ì‹¤ì œ ê°€ì´ë“œ ë¬¸ì„œ ë§í¬ë¡œ ë³€ê²½
        const guides = {
          app: "https://docs.google.com/presentation/d/1UvG6Vl1lWJlcOITc3KmaJboFYnmo1FDiJ-nk9qrsrH8/edit?slide=id.g37e30063af9_0_89#slide=id.g37e30063af9_0_89",
          check:
            "https://docs.google.com/presentation/d/1UvG6Vl1lWJlcOITc3KmaJboFYnmo1FDiJ-nk9qrsrH8/edit?slide=id.g37e30063af9_0_231#slide=id.g37e30063af9_0_231",
        };
        if (guides[type]) {
          window.open(guides[type], "_blank");
        }
      }

      // ===== ìƒíƒœë³„ ìƒ‰ìƒ =====
      function getStatusColor(status) {
        const colors = {
          ëŒ€ê¸°ì¤‘: "#6c757d",
          ìŠ¬ë™ì°¸ì—¬: "#2196f3",
          ë°œì†¡ì™„ë£Œ: "#ffa500",
          ìˆ˜ë ¹ì™„ë£Œ: "#2196f3",
          ì—°ë™ëŒ€ê¸°: "#ff6b6b",
          ìˆ˜ì§‘ì¤‘: "#4caf50",
          ìˆ˜ì§‘ì™„ë£Œ: "#4caf50",
          ë°ì´í„°í™•ì¸ì™„ë£Œ: "#2196f3",
          ë°ì´í„°ì œì¶œì™„ë£Œ: "#667eea",
          ë§¤ë‹ˆì €í™•ì¸ì™„ë£Œ: "#4caf50",
        };
        return colors[status] || "#6c757d";
      }

      // ===== ì—ëŸ¬ í‘œì‹œ =====
      function showError(elementId, message) {
        const errorDiv = document.getElementById(elementId);
        errorDiv.textContent = "âŒ " + message;
        errorDiv.style.display = "block";
      }

      // ===== ë¡œê·¸ì•„ì›ƒ =====
      function logout() {
        currentUser = null;
        document.getElementById("login-card").style.display = "block";
        document.getElementById("progress-card").style.display = "none";
        document.getElementById("participant-id").value = "";
        document.getElementById("participant-name").value = "";
      }

      // ===== URL íŒŒë¼ë¯¸í„° ìë™ ë¡œê·¸ì¸ =====
      window.onload = function () {
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get("id");
        const name = urlParams.get("name");

        if (id && name) {
          document.getElementById("participant-id").value = id;
          document.getElementById("participant-name").value = name;
          // ìë™ ë¡œê·¸ì¸ ì›í•˜ë©´ login() í˜¸ì¶œ
        }
      };
    </script>
  </body>
</html>
